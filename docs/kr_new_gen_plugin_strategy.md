# kr_new_gen - 插件化与策略驱动增强能力说明

本部分文档说明的是 `kr_new_gen` 项目中新增的“插件化”与“策略驱动”能力模块，这些模块在原有通用功能基础上新增，非对项目整体的完整描述。

---

## 🧠 增强能力概述

| 能力模块             | 描述                                                                 |
|----------------------|----------------------------------------------------------------------|
| 策略执行层 Strategy  | 将业务动作（如保存、查询等）解耦为不同策略实现，统一接口、配置决定行为 |
| 模式化数据策略       | 支持如“草稿模式”、“暂存/发布”、“缓存查询”、“联动保存”等业务语义      |
| 插件式组件模型       | UI、字段、验证、行为可由插件注册，允许不同项目自由组合                    |
| 业务字段语义扩展     | 字段支持复合结构（如日期范围）、正则匹配、权限控制、自动填充等            |
| 元数据驱动            | 支持通过元配置生成 CRUD + 查询等逻辑流程                               |
| AI 补全与辅助        | 接入 AI 模型辅助生成 DSL、表单字段、业务逻辑（如 prompt patch）          |

---

## 🏗️ 架构流程简述（增强部分）

```plaintext
  DSL 配置
      ↓
   Taglib 渲染层 (UI结构)
      ↓
   Mid UI Bridge (页面中间层)
      ↓
   Backend Model & Strategy
      ↓
   Mongo 数据模型 / 缓存 / 策略执行
```

---

## 📌 注意事项

- 本模块作为 `kr_new_gen` 的增强扩展，不改变原有功能栈。
- 插件机制与策略注册机制可独立接入任意业务模块。
- 强调“中间层厚模型”，通过元数据与策略逻辑解耦业务与存储层。

# kr_new_gen 插件体系类别与能力清单

本清单说明 `kr_new_gen` 插件机制中支持的插件类别及其对应的功能能力。

---

## 🔌 插件类别一览

| 插件类别       | 描述                                                  | 示例 |
|----------------|-------------------------------------------------------|------|
| UI 组件插件    | 注册新的可视化组件，支持配置项、渲染逻辑、交互行为等     | 表格、树、图表、自定义弹窗 |
| 字段插件       | 定义业务字段的类型、验证规则、默认值、复合结构等         | 日期范围字段、门店选择器、人员多选 |
| 表单行为插件   | 控制表单的交互行为、数据预处理、联动逻辑等               | 自动填充当前用户、表单间字段联动 |
| 策略插件       | 针对某个业务动作（如 save/query/submit）定义执行策略     | 草稿保存策略、发布策略、历史+今日查询策略 |
| 数据源插件     | 支持自定义数据源的连接、字段映射、缓存策略等             | 远程 API 表格、混合缓存查询 |
| 权限插件       | 注册字段或模型层级的数据权限校验策略                     | 门店隔离、员工数据过滤 |
| 操作钩子插件   | 注入 before/after/save/query/delete 等操作钩子            | 保存前重命名字段、删除后写日志 |
| DSL 语义插件   | 扩展 DSL 层的语义、指令或结构                            | 自定义组件指令、自定义循环逻辑 |
| 渲染插件       | 插件控制 ERB/Vue/Layui 等不同前端渲染目标的生成          | 生成 Layui 页面结构、自定义 Vue 组件嵌套 |
| AI Prompt 插件 | 接入 AI 生成提示、生成字段定义、校验规则、字段翻译等      | 自动生成表单、翻译模型字段名 |

---

## 🧩 插件注册点机制

- 每类插件拥有独立的注册 API
- 插件以 `name` + `type` 唯一标识
- 插件注册后可按 DSL / 策略模型 / 业务调用链路自动识别并执行
- 插件支持组合、配置优先级和上下文启用

---

## 📌 插件能力小结

- 模块化注册、按需加载
- 支持组合策略（如草稿 + 暂存/发布并行）
- 与元数据、DSL、策略引擎解耦
- 插件可热插拔或项目内定义覆盖

